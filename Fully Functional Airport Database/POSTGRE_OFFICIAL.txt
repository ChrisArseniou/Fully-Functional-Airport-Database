CREATE TABLE PASSENGER ( 
	AFM CHAR(20) NOT NULL,
	FULL_NAME CHAR(20) NOT NULL,
	PHONE_NUMBER CHAR(20),
	AGE INTEGER,
	ADDRESS CHAR(20),
	EMAIL CHAR(20),
	FREQUENT_FLIER_NO INTEGER,
PRIMARY KEY(AFM));



CREATE TABLE AIRPORT ( 
	ADDRESS	CHAR(30) NOT NULL,
PRIMARY KEY(ADDRESS));




CREATE TABLE AIRPLANE ( 
	MODEL_NUMBER CHAR(20),
	CAPACITY INTEGER,
	REGISTRATION_NUMBER CHAR(30) NOT NULL,
	ADDRESS CHAR(30),
PRIMARY KEY (REGISTRATION_NUMBER),
FOREIGN KEY (ADDRESS) REFERENCES AIRPORT(ADDRESS) ON DELETE SET NULL ON UPDATE SET DEFAULT);




CREATE TABLE FLIGHT ( 
	DURATION INTEGER,
	FLIGHT_NUMBER CHAR(20) NOT NULL,
	
	ARRIVAL_ADDRESS CHAR(30),
	ARRIVAL_TIME TIME,
	ARRIVAL_DATE DATE,
	
	DEPARTURE_ADDRESS CHAR(30),
	DEPARTURE_DATE DATE,
	DEPARTURE_TIME TIME,
	
	PLANE_REGISTRATION_NUMBER CHAR(30) NOT NULL,

PRIMARY KEY(FLIGHT_NUMBER),
FOREIGN KEY (PLANE_REGISTRATION_NUMBER) REFERENCES AIRPLANE(REGISTRATION_NUMBER) ON DELETE CASCADE ON UPDATE SET DEFAULT,
FOREIGN KEY (ARRIVAL_ADDRESS) REFERENCES AIRPORT(ADDRESS) ON DELETE SET NULL ON UPDATE SET DEFAULT,
FOREIGN KEY (DEPARTURE_ADDRESS) REFERENCES AIRPORT(ADDRESS) ON DELETE SET NULL ON UPDATE SET DEFAULT);





CREATE TABLE BOOKING_TICKET ( 
	TICKET_ID CHAR(20) NOT NULL,
	AFM CHAR(20) NOT NULL,
	FLIGHT_NUMBER CHAR(20) NOT NULL,
	DATE_OF_RESERVATION DATE,
	TIME_OF_RESERVATION TIME,
PRIMARY KEY(TICKET_ID),
FOREIGN KEY (AFM) REFERENCES PASSENGER(AFM) ON DELETE SET NULL ON UPDATE SET DEFAULT,
FOREIGN KEY (FLIGHT_NUMBER) REFERENCES FLIGHT(FLIGHT_NUMBER) ON DELETE CASCADE ON UPDATE SET DEFAULT);





CREATE TABLE CANCEL ( 
	CANCEL_ID CHAR(20) NOT NULL,
	TICKET_ID CHAR(20) NOT NULL,
	AFM CHAR(20) NOT NULL,
PRIMARY KEY (CANCEL_ID, TICKET_ID, AFM),
FOREIGN KEY (TICKET_ID) REFERENCES BOOKING_TICKET(TICKET_ID) ON DELETE CASCADE ON UPDATE SET DEFAULT,
FOREIGN KEY (AFM) REFERENCES PASSENGER(AFM) ON DELETE CASCADE ON UPDATE SET DEFAULT);


CREATE VIEW AIRPLANES_IN_ATHENS AS
	SELECT * FROM AIRPLANES
	WHERE ADDRESS = 'ATHENS ATH GR'


CREATE VIEW FLIGHTS_LAND_IN_ATH AS
	SELECT FLIGHT_NUMBER,ARRIVAL_DATE,PLANE_REGISTRATION_NUMBER,ARRIVAL_TIME
	FROM FLIGHT
	WHERE ARRIVAL_ADDRESS = 'ATHENS ATH GR'

CREATE VIEW FLIGHTS_TAKE_OFF_FROM_ATH AS
	SELECT FLIGHT_NUMBER,PLANE_REGISTRATION_NUMBER,DEPARTURE_DATE,DEPARTURE_TIME
	FROM FLIGHT
	WHERE DEPARTUDE_ADDRESS = 'ATHENS ATH GR'

